!function(o){"use strict";var p=[],l=[],d=[],u=[],c=[];function i(t){t.each(function(){if(o(this).parents(".tocopy").length<=0){vp.init_controls(o(this));var t=o(this).attr("id"),e=(o(this).attr("id"),o(this).attr("data-vp-validation")),i=o(this).attr("data-vp-bind"),a=o(this).attr("data-vp-items-bind"),n=o(this).attr("data-vp-dependency"),s=o(this).attr("data-active-callback"),r=o(this).getDatas().type;e&&p.push({name:t,rules:e,type:r}),void 0!==i&&!1!==i&&i&&l.push({bind:i,type:r,source:t}),void 0!==a&&!1!==a&&a&&d.push({bind:a,type:r,source:t}),void 0!==n&&!1!==n&&n&&u.push({dep:n,type:"field",source:t}),void 0!==s&&!1!==s&&s&&c.push({callback:s,type:"field",source:t})}})}function a(t){t.each(function(){if(o(this).parents(".tocopy").length<=0&&!o(this).hasClass(".tocopy")){var t=o(this).attr("data-vp-dependency"),e=o(this).attr("data-active-callback"),i=(o(this).getDatas().type,o(this).attr("id"));void 0!==t&&!1!==t&&t&&u.push({dep:t,type:"section",source:i}),void 0!==e&&!1!==e&&e&&c.push({callback:e,type:"section",source:i})}})}function s(t){for(var e=0;e<t.length;e++){var i=t[e],a=i.bind.split("|"),n=a[0],s=a[1],r=[],o="";o=(o=i.source.replace("[]","")).substring(0,o.lastIndexOf("[")),s=s.split(/[\s,]+/);for(var p=0;p<s.length;p++)s[p]=o+"["+s[p]+"]",r.push(s[p]);for(p=0;p<r.length;p++)vp.binding_event(r,p,i,n,".vp-metabox","metabox")}}function r(t){for(var e=0;e<t.length;e++){var i=t[e],a=i.bind.split("|"),n=a[0],s=a[1],r=[],o="";o=(o=i.source.replace("[]","")).substring(0,o.lastIndexOf("[")),s=s.split(/[\s,]+/);for(var p=0;p<s.length;p++)s[p]=o+"["+s[p]+"]",r.push(s[p]);for(p=0;p<r.length;p++)vp.items_binding_event(r,p,i,n,".vp-metabox","metabox")}}function v(t){for(var e=0;e<t.length;e++){var i=t[e],a=i.dep.split("|"),n=a[0],s=a[1],r=[],o="";if("field"===i.type)o=(o=i.source.replace("[]","")).substring(0,o.lastIndexOf("["));else if("section"===i.type){o=0<jQuery(vp.jqid(i.source)).parents(".wpa_group").length?jQuery(vp.jqid(i.source)).parents(".wpa_group").first().attr("id"):(o=jQuery(vp.jqid(i.source)).parents(".postbox").attr("id")).substring(0,o.lastIndexOf("_"))}s=s.split(",");for(var p=0;p<s.length;p++)s[p]=o+"["+s[p]+"]",r.push(s[p]);for(p=0;p<r.length;p++)vp.dependency_event(r,p,i,n,".vp-metabox")}}function h(t){for(var e=0;e<t.length;e++){var i=t[e],a=JSON.parse(i.callback),n="";if("field"===i.type)n=(n=i.source.replace("[]","")).substring(0,n.lastIndexOf("["));else if("section"===i.type){n=0<jQuery(vp.jqid(i.source)).parents(".wpa_group").length?jQuery(vp.jqid(i.source)).parents(".wpa_group").first().attr("id"):(n=jQuery(vp.jqid(i.source)).parents(".postbox").attr("id")).substring(0,n.lastIndexOf("_"))}for(var s=0;s<a.length;s++){f(n+"["+a[s].field+"]",n,i)}g(n,i)}}function f(t,e,i){var a=vp.thejqname(t,"option");o(".vp-metabox").on("change",a,function(){g(e,i)})}function g(t,e){for(var i=JSON.parse(e.callback),a=jQuery(vp.jqid(e.source)),n=[],s=!0,r=0;r<i.length;r++){var o=i[r],p=t+"["+o.field+"]",l=jQuery('[name="'+p+'"]').validationVal();n.push(jQuery(vp.jqid(p))),m(o.operator,o.value,l)||(s=!1)}s?(a.removeClass("vp-dep-inactive"),a.vp_fadeIn()):(a.addClass("vp-dep-inactive"),a.vp_fadeOut())}function m(t,e,i){return"==="===t?e===i:"="===t||"=="===t?e==i:"!=="===t?e!==i:"!="===t?e!=i:">="===t?i<=e:"<="===t?e<=i:">"===t?i<e:"<"===t?e<i:"in"===t?0<=e.indexOf(i):"ex"===t?e.indexOf(i)<0:void 0}o(".vp-metabox").on("click",".vp-wpa-group-title",function(t){t.preventDefault();var e=o(this).parents(".wpa_group:first"),i=e.find(".vp-controls:first");e.siblings(".wpa_group:not(.tocopy)"),o("html, body");return i.hasClass("vp-hide")?i.slideUp(0,function(){o(this).removeClass("vp-hide").slideDown("fast")}):i.slideUp("fast",function(){o(this).addClass("vp-hide").slideDown(0)}),!1}),o(document).ready(function(){var n;i(jQuery(".vp-metabox .vp-field")),a(jQuery(".vp-metabox .vp-meta-group")),s(l),r(d),v(u),h(c),n=[],o(".wpa_loop.vp-sortable").sortable({items:">.wpa_group",handle:".vp-wpa-group-heading",axis:"y",opacity:.5,tolerance:"pointer",start:function(t,e){void 0!==window.KIA_metabox&&(n=[],vp.tinyMCE_save(),o(e.item).find(".customEditor textarea").each(function(){if(o(this).parents(".tocopy").length<=0){try{tinyMCE.execCommand("mceRemoveControl",!1,this.id)}catch(t){}n.push(vp.jqid(this.id))}}))},stop:function(t,e){if(void 0!==window.KIA_metabox){for(var i=n.length-1;0<=i;i--)(a=o(n[i])).val(switchEditors.wpautop(a.val()));n=n.join(", ");try{for(KIA_metabox.runTinyMCE(o(n)),vp.tinyMCE_save(),i=n.length-1;0<=i;i--){var a;(a=o(n[i])).val(switchEditors.pre_wpautop(a.val()))}}catch(t){}}}})}),vp.is_multianswer=function(t){return-1!==jQuery.inArray(t,["vp-checkbox","vp-checkimage","vp-multiselect"])},vp.custom_check_radio_event(".vp-metabox",".vp-field.vp-checkimage .field .input label"),vp.custom_check_radio_event(".vp-metabox",".vp-field.vp-radioimage .field .input label"),o("#post").on("submit",function(t){var e,i=o("input[type=submit][clicked=true]"),a=i.val();if(vp.tinyMCE_save(),o(".vp-field").removeClass("vp-error"),o(".validation-msg.vp-error").remove(),o(".vp-metabox-error").remove(),0<(e=vp.fields_validation_loop(p))){var n=o('<span class="vp-metabox-error vp-js-tipsy" original-title="'+e+' error(s) found in metabox"></span>');"Save Draft"===a?(o("#minor-publishing-actions .spinner, #minor-publishing-actions .ajax-loading").hide(),n.tipsy(),n.insertAfter("#minor-publishing-actions .spinner, #minor-publishing-actions .ajax-loading"),o("#save-post").prop("disabled",!1).removeClass("button-disabled")):"Publish"!==a&&"Update"!==a||(o("#publishing-action .spinner, #publishing-action .ajax-loading").hide(),n.tipsy(),n.insertAfter("#publishing-action .spinner, #publishing-action .ajax-loading"),o("#publish").prop("disabled",!1).removeClass("button-primary-disabled"));var s=Math.ceil((i.outerHeight()-n.height())/2);return 0<s&&n.css("margin-top",s),void t.preventDefault()}o(this).find(".vp-toggle .vp-input").each(function(){var t=o("<input>",{type:"hidden",name:this.name,value:0});o(this).before(t)})}),o("#post input[type=submit]").click(function(){o("input[type=submit]",o(this).parents("form")).removeAttr("clicked"),o(this).attr("clicked","true")}),o.wpalchemy.on("wpa_copy",function(t,e){l=[],u=[],d=[],e.find('input[class="tocopy-hidden"]').first().remove(),i(e.find(".vp-field")),a(e.find(".vp-meta-group")),e.find(".vp-wpa-group-title:first").click(),s(l),r(d),v(u),h(c)})}(jQuery),function(i){"use strict";i(document).ready(function(){i(".vp-multiauthor-wrapper input.input-sortable").each(function(){if(i(this).hasClass("selectized"));else{var t=i(this),e=t.parent().find(".data-option"),a=!1;t.hasClass("vp-ajax-load")&&(a=!0),e.length&&(e=JSON.parse(e.text()),i(this).selectize({plugins:["drag_drop","remove_button"],options:e,persist:!0,create:!0,hideSelected:!0,valueField:"value",labelField:"text",render:{option:function(t,e){var i=t.text;return a?void 0===i?"<div><span>"+t.value+"</span></div>":"<div><span>"+i+"</span></div>":'<div class="'+t.class+'"><span>'+t.text+"</span></div>"}},load:function(t,e){if(a){if(!t.length||t.length<3)return e();i.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{string:encodeURIComponent(t),action:"vp_find_ajax_author"},error:function(){e()},success:function(t){e(t)}})}}}))}}),i(".vp-multitermhierarchy-wrapper input.input-sortable").each(function(){if(i(this).hasClass("selectized"));else{var t=i(this),e=t.parent().find(".data-option"),a=!1;t.hasClass("vp-ajax-load")&&(a=!0),e.length&&(e=JSON.parse(e.text()),i(this).selectize({plugins:["drag_drop","remove_button"],options:e,persist:!0,create:!0,hideSelected:!0,render:{option:function(t,e){var i=t.text;return a?void 0===i?"<div><span>"+t.value+"</span></div>":"<div><span>"+i+"</span></div>":'<div class="'+t.class+'"><span>'+t.text+"</span></div>"}},load:function(t,e){if(a){if(!t.length||t.length<3)return e();i.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{string:encodeURIComponent(t),action:"vp_find_ajax_post_category"},error:function(){e()},success:function(t){e(t)}})}}}))}}),i(".vp-singletermhierarchy-wrapper input.input-sortable").each(function(){if(i(this).hasClass("selectized"));else{var t=i(this),e=t.parent().find(".data-option"),a=!1;t.hasClass("vp-ajax-load")&&(a=!0),e.length&&(e=JSON.parse(e.text()),i(this).selectize({plugins:["drag_drop","remove_button"],options:e,persist:!0,create:!0,hideSelected:!0,render:{option:function(t,e){var i=t.text;return a?void 0===i?"<div><span>"+t.value+"</span></div>":"<div><span>"+i+"</span></div>":'<div class="'+t.class+'"><span>'+t.text+"</span></div>"}},load:function(t,e){if(a){if(!t.length||t.length<3)return e();i.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{string:encodeURIComponent(t),action:"vp_find_ajax_post_category"},error:function(){e()},success:function(t){e(t)}})}},onItemAdd:function(){var t=this.items;if(1<t.length)for(var e=0;e<t.length;e++)this.removeItem(t[e])}}))}}),i(".vp-multipost-wrapper input.input-sortable").each(function(){if(i(this).hasClass("selectized"));else{var t=i(this).parent().find(".data-option");t=JSON.parse(t.text()),i(this).selectize({plugins:["drag_drop","remove_button"],persist:!0,create:!0,hideSelected:!0,valueField:"value",labelField:"text",options:t,render:{option:function(t,e){var i=t.text;return void 0===i?"<div><span>"+t.value+"</span></div>":"<div><span>"+i+"</span></div>"}},load:function(t,e){if(!t.length||t.length<3)return e();i.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{string:encodeURIComponent(t),action:"vp_find_ajax_post"},error:function(){e()},success:function(t){e(t)}})}})}}),i(".vp-multitag-wrapper input.input-sortable").each(function(){if(i(this).hasClass("selectized"));else{var t=i(this),e=t.parent().find(".data-option"),a=!1;t.hasClass("vp-ajax-load")&&(a=!0),e.length&&(e=JSON.parse(e.text()),i(this).selectize({plugins:["drag_drop","remove_button"],options:e,persist:!0,create:!0,hideSelected:!0,valueField:"value",labelField:"text",render:{option:function(t,e){var i=t.text;return a?void 0===i?"<div><span>"+t.value+"</span></div>":"<div><span>"+i+"</span></div>":'<div class="'+t.class+'"><span>'+t.text+"</span></div>"}},load:function(t,e){if(a){if(!t.length||t.length<3)return e();i.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{string:encodeURIComponent(t),action:"vp_find_ajax_post_tag"},error:function(){e()},success:function(t){e(t)}})}}}))}}),i(".vp-tabs").tabs()})}(jQuery);
